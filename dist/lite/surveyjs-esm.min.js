/* surveyJS Lite v4.0.2 | Valerio Di Punzio (@SimplySayHi) | https://www.valeriodipunzio.com/plugins/surveyJS/ | https://github.com/SimplySayHi/surveyJS | MIT license */
const e=e=>Element.prototype.isPrototypeOf(e),s="sjs:destroy",t="sjs:init",r=e=>(Object.getOwnPropertyNames(e).forEach((s=>{const t=e[s];"object"==typeof t&&null!==t&&r(t)})),Object.freeze(e)),a=e=>"[object Object]"===Object.prototype.toString.call(e),o=function(e={}){return Array.from(arguments).slice(1).filter((e=>!!e)).forEach((s=>{Object.keys(s).forEach((t=>{Array.isArray(s[t])?e[t]=(e[t]||[]).concat(s[t].slice(0)):a(s[t])?e[t]=o(e[t]||{},s[t]):Array.isArray(e[t])?e[t].push(s[t]):e[t]=s[t]}))})),e},i=(e,s,t)=>{t=o({},{bubbles:!0},t);const r=new CustomEvent(s,t);e.dispatchEvent(r)},l=(e,s)=>Object.keys(e).reduce(((s,t)=>{const r=new RegExp("{{"+t+"}}","g");return s.replace(r,e[t])}),s),n=e=>(e[0].sort&&e.sort(((e,s)=>e.sort>s.sort)),e),d=(e=[])=>n(e).reduce(((e,s)=>e+`<option value="${s.value}">${s.label}</option>`),""),c=(e,s,t)=>{const r=["data","id","label","nested","related","sort"];/^(option|textarea)$/.test(e.type)&&r.push("type","value");let a="";return Object.keys(e).filter((e=>-1===r.indexOf(e))).forEach((s=>{a+=` ${s}="${e[s]}"`})),e.data&&Object.keys(e.data).forEach((s=>{a+=` data-${((e="",s=!1)=>{let t=e.trim().replace(/(([_ ])([a-z]))|(([a-z])?([A-Z]))/g,((e,s,t,r,a,o,i)=>(r?"-"+r:(o||"")+"-"+i).toLowerCase()));return s?t.toUpperCase():t})(s)}="${e.data[s]}"`})),t&&(a+=" required"),e.related&&(a+=" data-require-more"),a+=` id="${s}"`,a.trim()},u=(e,s,t)=>{let r="",a="";return n(e).forEach(((i,n)=>{let p="";const y="option"===i.type?"select":i.type;if("select"===y&&a===y)return;a=y,s.question.checks&&(i=o({},i,{data:{checks:s.question.checks}}));const m=`${y}-${s.surveyId}-${s.question.id}-${"select"===y?n+1:i.id}`,f={questionNumber:s.question.index+1,wrapperClasses:t.cssClasses.wrapper[y]||t.cssClasses.wrapper.field,fieldAttributes:c(i,m,s.question.isRequired),fieldClasses:t.cssClasses[y]||t.cssClasses.field,answerType:y,answerCode:m,addMoreName:"",labelString:i.label||"",labelClasses:t.cssClasses.label};let v="";if(i.related){const e=i.related.type||"select",s="select"===e,r=s?o({},i):i.related;r.type=s?"option":e,r.id="",r.data=o({},r.data,{requiredFrom:"#"+m}),delete r.related;const a={fieldAttributes:c(r,"",!1),answerType:e,addMoreName:"-more",fieldClasses:s?t.cssClasses.select:t.cssClasses[e]||t.cssClasses.field};if(v=t.templates[e]||t.templates.input,s){const e=d(i.related);v=v.replace("{{optionsHtml}}",e)}v=l(a,v)}const w=((e,s)=>({field:s[e]||s.input,label:/^(checkbox|nested|radio|related)$/.test(e)?s.label:"",wrapper:s.wrapper[e]||s.wrapper.field}))(i.related?"related":i.nested?"nested":y,t.templates);let h="";i.nested&&(h=u(i.nested,s,t));let b="";"select"===y&&(b=d(e)),p=w.wrapper.replace("{{relatedFieldHTML}}",v).replace("{{fieldTemplate}}",w.field).replace("{{optionsHtml}}",b).replace("{{labelTemplate}}",w.label).replace("{{nestedFieldsHTML}}",h),r+=l(f,p)})),r},p=(e,s,t)=>{const r=((e,s,t)=>n(e).reduce(((e,r,o)=>{if(r.external)return e;let i=t.templates.wrapper.question;const n=r.id,d=o+1,c={surveyId:s,question:{id:n,index:o,isRequired:!!r.required}};r.checks&&(c.question.checks=r.checks);const p=u(r.answers,c,t),y=r.checks?JSON.parse(r.checks):"",m=y[0]||"",f=y[1]||"",v=y&&t.messages.maxChoice?" ("+f+" "+t.messages.maxChoice+")":"",w={questionId:n,questionNumber:d,questionText:r.question+v,answersHTML:p};if(i=l(w,i),t.showErrorMessage){let e=""!==y?t.messages.errorMultiChoice:r.errorMessage||t.messages.error;a(e)&&(e=""),i=i.replace(/{{errorTemplates}}/g,e)}return e+l({checksMin:m,checksMax:f},i)}),""))(e.questions,e.id,t);s.querySelector("[data-surveyjs-body]").insertAdjacentHTML("beforeend",r);const o=e.questions.filter((e=>e.external));if(o.length>0){const t=s.closest("[data-surveyjs-wrapper]");o.forEach(((s,r)=>{const a=t.querySelector('[data-surveyjs-external="'+(r+1)+'"]');a.setAttribute("data-question-id",s.id),s.answers.forEach(((t,r)=>{const o=a.querySelectorAll("[data-field]")[r],i={id:`${t.type}-${e.id}-${s.id}-${t.id}`,type:t.type,value:t.value,required:!!s.required};Object.keys(i).forEach((e=>{o[e]=i[e]}));const l=o.closest("[data-answer]");l.querySelector("label").setAttribute("for",i.id),l.querySelector("[data-label]").innerHTML=t.label,a.querySelector("[data-question]").innerHTML=s.question}))}))}};class y{constructor(s,a={}){const l=arguments.length,n=(s=>{const t=typeof s,r="string"===t&&e(document.querySelector(s))&&"form"===document.querySelector(s).tagName.toLowerCase();return{result:e(s)||r,element:"string"===t?document.querySelector(s):s}})(s);if(0===l||l>0&&!s)throw new Error('First argument "$form" is missing or falsy!');if(d=s,NodeList.prototype.isPrototypeOf(d))throw new Error('First argument "$form" must be a single DOM node or a form CSS selector, not a NodeList!');var d;if(!n.result)throw new Error('First argument "$form" is not a DOM node nor a form CSS selector!');if(!a.url||"string"!=typeof a.url)throw new Error('"options.url" is missing or not a string!');const c=this;c.$form=n.element,c.options=o({},y.prototype.options,a),s=c.$form,a=c.options,s.surveyjs=c,s.querySelector("[data-surveyjs-body]").insertAdjacentHTML("beforebegin",a.templates.loading);const u=((e=location.href,s={})=>{let t;if(s.headers=new Headers(s.headers),s.timeout>0){const e=new AbortController,r=e.signal;s.signal=r,t=window.setTimeout((()=>{e.abort()}),s.timeout)}return fetch(e,s).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.json()})).catch((e=>{throw new Error(e.message)})).finally((()=>{t&&window.clearTimeout(t)}))})(a.url,a.initAjaxOptions).then((e=>"success"!==e.status.toLowerCase()?Promise.reject(e):(e.data.questions&&e.data.questions.length>0&&(p(e.data,s,a),Object.defineProperty(c,"data",{value:r(e.data)}),c.isInitialized=!0,s.closest("[data-surveyjs-wrapper]").classList.add("surveyjs-init-success")),e))).finally((()=>{const e=s.querySelector("[data-surveyjs-loading]");e&&e.parentNode.removeChild(e)}));i(s,t,{detail:u})}destroy(){delete this.$form.surveyjs,i(this.$form,s)}static setOptions(e){y.prototype.options=o({},y.prototype.options,e)}}y.prototype.isInitialized=!1,y.prototype.options={cssClasses:{checkbox:"form-check-input",field:"form-control",file:"form-control-file",label:"form-check-label",radio:"form-check-input",wrapper:{checkbox:"form-check",field:"",radio:"form-check"}},initAjaxOptions:{cache:"no-store",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},method:"GET",mode:"same-origin",redirect:"follow",timeout:0},messages:{maxChoice:"answers max",error:"Answer is necessary.",errorMultiChoice:"You must choose from {{checksMin}} to {{checksMax}} answers."},showErrorMessage:!0,templates:{error:'<div class="surveyjs-error-message">{{errorMessage}}</div>',input:'<input {{fieldAttributes}} name="surveyjs-answer-{{questionNumber}}{{addMoreName}}" class="surveyjs-input surveyjs-{{answerType}} {{fieldClasses}}" />',label:'<label for="{{answerCode}}" class="surveyjs-label {{labelClasses}}">{{labelString}}</label>',loading:'<div class="surveyjs-loading" data-surveyjs-loading>Loading...</div>',select:'<select {{fieldAttributes}} name="surveyjs-answer-{{questionNumber}}{{addMoreName}}" class="surveyjs-select {{fieldClasses}}">{{optionsHtml}}</select>',textarea:'<textarea {{fieldAttributes}} name="surveyjs-answer-{{questionNumber}}" class="surveyjs-textarea {{fieldClasses}}"></textarea>',wrapper:{field:'<div class="surveyjs-field-wrapper surveyjs-{{answerType}}-wrapper {{wrapperClasses}}">{{fieldTemplate}}{{labelTemplate}}</div>',nested:'<div class="surveyjs-field-wrapper surveyjs-nested-wrapper">{{labelTemplate}}<div class="surveyjs-nested-inner">{{nestedFieldsHTML}}</div></div>',question:'<div class="surveyjs-question-wrapper" data-question-id="{{questionId}}"><div class="surveyjs-question-text">{{questionText}}</div><div class="surveyjs-answers-wrapper">{{answersHTML}}</div><div class="surveyjs-errors-wrapper" data-surveyjs-errors>{{errorTemplates}}</div></div>',related:'<div class="surveyjs-field-wrapper surveyjs-related-wrapper input-group"><div class="input-group-prepend"><div class="surveyjs-radio-wrapper input-group-text form-check">{{fieldTemplate}}{{labelTemplate}}</div></div>{{relatedFieldHTML}}</div>'}}},y.prototype.version="4.0.2";export{y as default};
//# sourceMappingURL=surveyjs-esm.min.js.map
