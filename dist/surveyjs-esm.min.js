/* surveyJS v3.0.0 | Valerio Di Punzio (@SimplySayHi) | https://www.valeriodipunzio.com/plugins/surveyJS/ | https://github.com/SimplySayHi/surveyJS | MIT license */
import e from"formjs-plugin";const t=e=>(Object.getOwnPropertyNames(e).forEach(s=>{const r=e[s];"object"==typeof r&&null!==r&&t(r)}),Object.freeze(e)),s='[data-surveyjs-form] input:not([type="reset"]):not([type="submit"]):not([type="button"]), [data-surveyjs-form] select, [data-surveyjs-form] textarea, [data-name="bind-surveyjs-answer"]',r=e=>"[object Object]"===Object.prototype.toString.call(e),a=e=>r(e)&&0===Object.getOwnPropertyNames(e).length,o=function(e={}){for(let t=1;t<arguments.length;t++){const s=arguments[t];if(s)for(let t in s){const a=Array.isArray(s[t]),n=r(s[t]);s.hasOwnProperty(t)&&(a?(void 0===e[t]&&(e[t]=[]),e[t]=e[t].concat(s[t].slice(0))):n?e[t]=o(e[t],s[t]):Array.isArray(e[t])?e[t].push(s[t]):e[t]=s[t])}}return e},n=()=>{const e=(()=>{const e="check_storage";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}})();return e&&(Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){const t=this.getItem(e);return t&&JSON.parse(t)}),{isAvailable:e}},i=(e,t)=>{const s=e.questions,r=s.length;let a={};for(let e=0;e<r;e++){const r=s[e];if(r.id==t){a=r;break}}return a},l={formOptions:{beforeSend:function(e){const t=this.formEl.formjs,r=this.formEl.closest("[data-surveyjs-container]"),a=Array.from(r.querySelectorAll(s));let n="",l="";a.forEach(e=>{const s=e.type,r=e.name;if(r===n&&s===l)return;e.matches("[data-required-from]")||(n=r,l=s);const a=e.closest("[data-question-id]"),o=a?a.getAttribute("data-question-id"):"",d=i(t.data,o);if(""!==o&&d&&void 0!==d.required){const t=e.matches("[data-required-from]"),s=document.querySelector(e.getAttribute("data-required-from"));(!t||t&&s.checked)&&(e.required=!0)}});const d=o({},t.options.fieldOptions,{focusOnRelated:!1});return new Promise(t=>{this.formEl.formjs.validateForm(d).then(s=>{s.result||(e.stopExecution=!0),t(e)})})},getFormData:function(){const e=this.formEl,t=e.formjs,r=Array.from(e.closest("[data-surveyjs-container]").querySelectorAll(s)),o={answers:[],id:t.data.id};let n="",l="";return r.forEach(s=>{const r=s.type,d=s.name;if(d===n&&r===l)return;s.matches("[data-required-from]")||(n=d,l=r);const c=s.closest("[data-question-id]"),u=c?c.getAttribute("data-question-id"):"",p=s.value,m={question:u,answer:{id_answer:[p]}};if(!s.matches("[data-required-from]")&&""!==u&&!a(i(t.data,u))){if(s.matches("textarea")&&(m.answer.id_answer=[""],m.answer.text=p),"radio"===r){const t=(s.closest("form")?e:s.closest("[data-formjs-question]")).querySelector('[name="'+d+'"]:checked');t?(t.matches("[data-require-more]")&&(m.answer.attributes=e.querySelector('[data-required-from="#'+t.id+'"]').value.trim()),t.matches("[data-nested-index]")&&(m.answer.attributes=t.getAttribute("data-nested-index")),m.answer.id_answer=[t.value.trim()]):m.answer.id_answer=[""]}"checkbox"===r&&s.matches("[data-checks]")&&(m.answer.id_answer=[],Array.from(e.querySelectorAll('[name="'+d+'"]:checked')).forEach(e=>{m.answer.id_answer.push(e.value.trim())})),o.answers.push(m)}}),o}}},d={cssClasses:{checkbox:"form-check-input",default:"form-control",file:"form-control-file",label:"form-check-label",radio:"form-check-input",select:"form-control",textarea:"form-control"},fieldErrorFeedback:!0,formOptions:{beforeSend:[l.formOptions.beforeSend],getFormData:l.formOptions.getFormData},initAjaxOptions:{cache:"no-store",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},method:"GET",mode:"same-origin",redirect:"follow",timeout:0},lang:"en",templates:{fieldError:'<div class="surveyjs-field-error-message">{{fieldErrorMessage}}</div>',input:'<div class="surveyjs-single-answer surveyjs-input-container surveyjs-answer-{{answerType}} form-check" data-answer-index="{{answerIndex}}">{{inputTagCode}}{{labelTagCode}}</div>',inputGroup:'<div class="surveyjs-single-answer input-group" data-answer-index="{{answerIndex}}"><div class="input-group-prepend"><div class="input-group-text form-check surveyjs-answer-{{answerType}}"><input type="{{answerType}}" name="surveyjs-answer-{{questionNumber}}" id="{{answerCode}}" data-answer-id="{{answerId}}" value="{{answerIdValue}}" {{attrRequired}} data-require-more="" class="surveyjs-input surveyjs-radio form-check-input" /><label for="{{answerCode}}" class="surveyjs-label form-check-label">{{answerString}}</label></div></div>{{relatedAnswerField}}</div>',inputTag:'<input type="{{answerType}}" {{attrSubtype}} name="surveyjs-answer-{{questionNumber}}{{addMoreName}}" class="surveyjs-input surveyjs-{{answerType}} {{fieldClass}}" id="{{answerCode}}" {{nestedAnswer}} data-answer-root="{{progIdsJoined}}" data-answer-id="{{answerId}}" value="{{answerIdValue}}" {{attrRequired}} {{validateIfFilled}} {{attrChecks}} {{attrRequiredFrom}} />',labelTag:'<label for="{{answerCode}}" class="surveyjs-label {{labelClass}}">{{answerString}}</label>',question:'<div data-question-id="{{questionId}}" data-question-index="{{questionNumber}}" data-formjs-question class="surveyjs-question-box clearfix"><div class="surveyjs-question-header">Question {{questionNumber}}</div><div class="surveyjs-question-body"><div class="surveyjs-question-text">{{questionText}}</div><div class="surveyjs-answers-box form-group clearfix">{{answersHtml}}{{fieldErrorTemplate}}</div></div></div>',select:'<div class="surveyjs-single-answer surveyjs-answer-select" data-answer-index="{{answerIndex}}">{{selectTagCode}}</div>',selectTag:'<select id="{{answerCode}}" name="surveyjs-answer-{{questionNumber}}{{addMoreName}}" class="surveyjs-select {{fieldClass}}" {{attrRequired}} {{nestedAnswer}} data-answer-root="{{progIdsJoined}}" {{attrRequiredFrom}}>{{optionsHtml}}</select>',textarea:'<div class="surveyjs-single-answer surveyjs-answer-textarea"><textarea id="{{answerCode}}" data-answer-id="{{answerId}}" {{nestedAnswer}} name="surveyjs-answer-{{questionNumber}}" {{attrRequired}} class="surveyjs-textarea {{fieldClass}}" {{answerMaxlength}} rows="6" placeholder="{{answerPlaceholder}}"></textarea></div>'},useLocalStorage:!0},c={storageArray:[],storageName:"Survey_"+location.href+"_{{surveyFormName}}_surveyId[{{surveyId}}]"},u=(e,t,s="")=>{const r=localStorage.getObject(e.storageName);if(r){const e=r.length;for(let a=0;a<e;a++){const e=r[a];if(e.field===t){if(s&&e.value!==s)continue;return a}}}return-1},p=function(e){const t=e.type,s=e.target,r=s.closest("form").formjs,o=r.internals,n=s.closest("[data-formjs-question]"),l=s.value?s.value.trim():s.value,d=s.matches("[data-checks]"),c=s.matches("[data-require-more]"),p=s.matches("[data-required-from]"),m=p?n.querySelector(s.getAttribute("data-required-from")):null,f=p?m:s,y=f.id?f.id.split("-")[1]:"id-not-found",g=(e=>e.matches('select, [type="radio"], [type="checkbox"], [type="file"]'))(s),v=i(r.data,y);if(a(v))return!0;if(g&&"change"===t||!g&&"change"!==t){if(r.options.useLocalStorage&&!s.matches("[data-exclude-storage]")){const e=u(o,s.name,!!d&&l),t=u(o,s.name+"-more");let r=o.storageArray;if(c||p||-1===t||r.splice(t,1),-1!==e)d?s.checked||r[e].value!==l?r.push({field:s.name,value:l}):r.splice(e,1):""!==l?r[e].value=l:r.splice(e,1);else if(""!==l){if(p&&""!==l){const e=u(o,m.name);-1!==e&&r.splice(e,1),r.push({field:m.name,value:m.value.trim()})}if(r.push({field:s.name,value:l}),c){const e=s.closest("form").querySelector('[data-required-from="#'+s.id+'"]');r.push({field:e.name,value:e.value.trim()})}}localStorage.setObject(o.storageName,r)}void 0!==v.required&&(s.required=!0)}},m=(e=[],t)=>{let s=""===e[0].id?"":'<option value="">'+t.selectFirstOption+"</option>";return e.forEach(e=>{s+='<option value="'+e.id+'" data-answer-id="'+e.id+'">'+e.answer+"</option>"}),s},f={attribute:(e,t)=>{const s=t.objData,r=e.templates.inputGroup,a=t.answer.attribute,o=Array.isArray(a),n=o?e.templates.selectTag:e.templates.inputTag;return s.fieldClass=e.cssClasses.default,o&&(s.fieldClass=e.cssClasses.select,s.optionsHtml=m(a,e)),{aHtml:r,relatedAnswerField:n,objData:s}},input:(e,t)=>{const s=t.objData,r=t.beforeCode+e.templates.input+t.afterCode;return"checkbox"!==s.answerType&&"radio"!==s.answerType&&(s.nestedAnswer+=' class="'+s.fieldClass+'"'),{aHtml:r,objData:s}},nested:(e,t)=>{const s=t.objData;let r=e.templates.labelTag;r=r.replace(/{{answerCode}}/g,s.answerCode),r=r.replace(/{{labelClass}}/g,e.cssClasses.label+" surveyjs-field-indent-0"),r=r.replace(/{{answerString}}/g,t.answer.answer);return{aHtml:t.beforeCode+'<div class="surveyjs-'+s.answerType+'">'+r+"</div>"+t.afterCode,objData:s}},select:(e,t)=>{const s=t.objData,r=t.beforeCode+e.templates.select+t.afterCode;return s.optionsHtml=m(t.obj.answers,e),{aHtml:r,objData:s}},textarea:(e,t)=>{const s=t.objData,r=e.templates.textarea;return s.answerPlaceholder=t.answer.placeholder||e.textareaPlaceholder,{aHtml:r,objData:s}}},y=(e,t,s)=>{if(""!==s.optionsHtml&&(t.aHtml=t.aHtml.replace(/{{selectTagCode}}/g,e.templates.selectTag)),t.relatedAnswerField){const e={answerCode:"",answerType:"text",fieldClass:s.fieldClass,answerIdValue:"",attrRequired:"",addMoreName:"-more",attrRequiredFrom:'data-required-from="#'+s.answerCode+'"'};for(let s in e){const r=new RegExp("{{"+s+"}}","g");t.relatedAnswerField=t.relatedAnswerField.replace(r,e[s])}t.aHtml=t.aHtml.replace(/{{relatedAnswerField}}/g,t.relatedAnswerField)}else t.aHtml=t.aHtml.replace(/{{addMoreName}}/g,""),t.aHtml=t.aHtml.replace(/{{attrRequiredFrom}}/g,"");for(let e in s){const r=new RegExp("{{"+e+"}}","g");t.aHtml=t.aHtml.replace(r,s[e])}return t.aHtml};let g=[];const v=(e,t,s,r,a,o)=>{r=s.id?s.id:r||0;let n=Array.isArray(s)?s:s.answers,i=n.length,l=a||0,d="";const c="hidden-privacy"===s.question;n[0].sort&&n.sort((e,t)=>e.sort>t.sort);for(let a=0;a<i;a++){let u=n[a],p=a+1,m=l+1,w=u.type,h=u.id,b=g.length,j=b>0?g.join("-"):"",q=()=>{let e="option"===u.type?"select":u.type;return t.cssClasses[e]||t.cssClasses.default},x={aHtml:""},C={labelTagCode:"checkbox"===w||"radio"===w?t.templates.labelTag:"",answerId:h,answerIdValue:"text"===w?"":h,answerIndex:p,answerName:"surveyjs-answer-"+m,answerPlaceholder:"",answerMaxlength:u.maxlength?'maxlength="'+u.maxlength+'"':"",answerString:"string"==typeof u.answer?u.answer:"",answerType:w,attrRequired:void 0!==s.required?"required":void 0!==o?o:"",fieldClass:q(),nestedAnswer:""!==j?'data-nested-index="'+p+'"':"",optionsHtml:"",progIdsJoined:j,questionNumber:m,answerCode:("option"===w?"select":w)+"-"+r+"-"+(h||0)+"-"+m+(""!==j?"-"+j:"")+"-"+p,attrChecks:s.checks?'data-checks="'+s.checks+'"':"",attrSubtype:u.subtype?'data-subtype="'+u.subtype+'"':"",validateIfFilled:void 0!==s.validateIfFilled?"data-validate-if-filled":""};if(c){const t=e.closest("[data-surveyjs-container]").querySelectorAll('[data-name="bind-surveyjs-answer"]')[a],r={id:C.answerCode,name:C.answerName,type:w,value:C.answerId};void 0!==s.required&&(r.required=!0);for(let e in r)t[e]=r[e];t.setAttribute("data-answer-id",C.answerId),t.closest("div").querySelector("label").setAttribute("for",C.answerCode),t.closest("div").querySelector("label span").textContent=u.answer}else{if("string"==typeof u.answer||"number"==typeof u.answer){let o=u.attribute?"attribute":u.nested?"nested":"option"===w?"select":w,n={answer:u,objData:C,beforeCode:b>0&&0===a?'<div class="surveyjs-field-indent">':"",afterCode:b>0&&a===i-1?"</div>":"",obj:s};if(void 0===f[o]&&(o="input"),x=f[o](t,n),C=x.objData,u.nested){g.push(p),d+=x.aHtml,d+=v(e,t,u.nested,r,l,C.attrRequired);continue}b>0&&a===i-1&&g.pop()}x.aHtml=y(t,x,C),d+=x.aHtml,"option"===w&&(a+=s.answers.length)}}return d},w=(e,t,s,r)=>{const a=e.formjs,o=e.getAttribute("name")||"",n=e.closest("[data-surveyjs-container]");a.internals.storageName=s.storageName.replace(/{{surveyId}}/g,r.id),a.internals.storageName=s.storageName.replace(/{{surveyFormName}}/g,o);const i=e=>void 0!==e?e:"";n.querySelector("[data-surveyjs-title]")&&(n.querySelector("[data-surveyjs-title]").textContent=i(r.title)),n.querySelector("[data-surveyjs-description]")&&(n.querySelector("[data-surveyjs-description]").textContent=i(r.description));((e,t)=>{const s=document.createElement("div");s.innerHTML=e,Array.from(s.childNodes).forEach(e=>{t.appendChild(e)})})(((e,t,s=[])=>{const r=s[0].sort?s.sort((e,t)=>e.sort>t.sort):s,a=r.length;let o="";for(let s=0;s<a;s++){const a=r[s],n=a.checks?JSON.parse(a.checks):"",i=n.length>0?n[0]:"",l=n.length>0?n[1]:"";let d="",c=t.templates.question;if(d+=v(e,t,a,a.id,s),"hidden-privacy"===a.question){const t=e.closest("[data-surveyjs-container]").querySelector('[data-name="bind-surveyjs-answer"]');if(t){t.closest("[data-formjs-question]").setAttribute("data-question-id",a.id);continue}}if(c=c.replace(/{{questionId}}/g,a.id),c=c.replace(/{{questionNumber}}/g,s+1),c=c.replace(/{{questionText}}/g,a.question+(""!==n?" ("+l+" "+t.maxChoiceText+")":"")),c=c.replace(/{{answersHtml}}/g,d),c=c.replace(/{{fieldErrorTemplate}}/g,t.fieldErrorFeedback?t.templates.fieldError:""),t.fieldErrorFeedback&&-1!==t.templates.fieldError.indexOf("{{fieldErrorMessage}}")){const e=""!==n?t.fieldErrorMessageMultiChoice:t.fieldErrorMessage;c=c.replace(/{{fieldErrorMessage}}/g,e).replace(/{{checksMin}}/g,i).replace(/{{checksMax}}/g,l)}o+=c}return o})(e,t,r.questions),e.querySelector("[data-surveyjs-body]")),t.useLocalStorage&&((e,t)=>{const s=localStorage.getObject(t.storageName);if(s){const r=e.closest("[data-surveyjs-container]");t.storageArray=s,s.forEach(e=>{const t=r.querySelector('[name="'+e.field+'"]'),s=t.matches('[type="radio"], [type="checkbox"]'),a=s?r.querySelector('[name="'+e.field+'"][value="'+e.value+'"]'):t;s?a.checked=!0:a.value=e.value})}})(e,a.internals);const l=e.querySelector("[data-surveyjs-loading]");l&&l.parentNode.removeChild(l)};class h extends e{constructor(e,t={}){if(!t.url||"string"!=typeof t.url)throw new Error('"options.url" is missing or not a string!');const s="string"==typeof t.lang&&t.lang.toLowerCase(),r=s&&h.prototype.messages[s]?s:h.prototype.options.lang,a=o({},h.prototype.options,h.prototype.messages[r],t);-1!==a.templates.input.indexOf("{{inputTagCode}}")&&(a.templates.input=a.templates.input.replace(/{{inputTagCode}}/g,a.templates.inputTag)),a.templates.labelTag=a.templates.labelTag.replace(/{{labelClass}}/g,a.cssClasses.label),n().isAvailable||(a.useLocalStorage=!1),super(e,a),this.internals=c,this.options.fieldOptions.validateOnEvents.split(" ").forEach(t=>{const s="blur"===t;e.addEventListener(t,p,s)}),e.addEventListener("fjs.form:submit",e=>{e.data.then(()=>{a.useLocalStorage&&localStorage.removeItem(this.internals.storageName)})})}destroy(){var e;(e=this.formEl).formjs.options.fieldOptions.validateOnEvents.split(" ").forEach(t=>{const s="blur"===t;e.removeEventListener(t,p,s)}),super.destroy()}init(){const e=this,s=e.formEl,r=e.options;return s.querySelector("[data-surveyjs-body]").insertAdjacentHTML("beforebegin",r.loadingBox),((e=location.href,t={})=>{let s;if(t.headers=new Headers(t.headers),t.timeout>0){const e=new AbortController,r=e.signal;t.signal=r,s=window.setTimeout(()=>{e.abort()},t.timeout)}return fetch(e,t).then(e=>e.ok?e.json():Promise.reject(e)).catch(e=>Promise.reject(e)).finally(()=>{s&&window.clearTimeout(s)})})(r.url,r.initAjaxOptions).then(a=>"success"===a.status.toLowerCase()&&a.data.questions&&a.data.questions.length>0?new Promise(o=>{w(s,r,e.internals,a.data),super.init().then(()=>{e.isInitialized=!0,e.data=a.data,t(e.data),s.closest("[data-surveyjs-container]").classList.add("surveyjs-init-success"),o(a)})}):Promise.reject(a))}static addLanguage(e,t){const s=e.toLowerCase();h.prototype.messages[s]=o({},h.prototype.messages[s],t)}static setOptions(e){h.prototype.options=o({},h.prototype.options,e)}}h.prototype.isInitialized=!1,h.prototype.messages={it:{loadingBox:'<div class="surveyjs-loading" data-surveyjs-loading><i class="glyphicon glyphicon-refresh icon-spin"></i> Caricamento in corso...</div>',selectFirstOption:"Seleziona una risposta...",textareaPlaceholder:"Scrivi la tua risposta...",maxChoiceText:"RISPOSTE MAX",fieldErrorMessage:"&Egrave; necessario rispondere.",fieldErrorMessageMultiChoice:"Puoi scegliere da {{checksMin}} a {{checksMax}} risposte."},en:{loadingBox:'<div class="surveyjs-loading" data-surveyjs-loading><i class="glyphicon glyphicon-refresh icon-spin"></i> Loading...</div>',selectFirstOption:"Select your answer...",textareaPlaceholder:"Write here your answer...",maxChoiceText:"ANSWERS MAX",fieldErrorMessage:"Answer is necessary.",fieldErrorMessageMultiChoice:"You can choose from {{checksMin}} to {{checksMax}} answers."}},h.prototype.options=d,h.prototype.version="3.0.0";export default h;
//# sourceMappingURL=surveyjs-esm.min.js.map
