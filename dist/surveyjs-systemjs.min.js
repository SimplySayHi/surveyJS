/* surveyJS v3.0.0 | Valerio Di Punzio (@SimplySayHi) | https://www.valeriodipunzio.com/plugins/surveyJS/ | https://github.com/SimplySayHi/surveyJS | MIT license */
System.register(["formjs-plugin"],(function(e){"use strict";var t;return{setters:[function(e){t=e.default}],execute:function(){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(e):t}function f(e){var t=l();return function(){var r,a=i(e);if(t){var s=i(this).constructor;r=Reflect.construct(a,arguments,s)}else r=a.apply(this,arguments);return d(this,r)}}function p(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}function v(e,t,r){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var a=p(e,t);if(a){var s=Object.getOwnPropertyDescriptor(a,t);return s.get?s.get.call(r):s.value}})(e,t,r||e)}var m=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.href,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.headers=new Headers(r.headers),r.timeout>0){var a=new AbortController,s=a.signal;r.signal=s,e=window.setTimeout((function(){a.abort()}),r.timeout)}return fetch(t,r).then((function(e){return e.ok?e.json():Promise.reject(e)})).catch((function(e){return Promise.reject(e)})).finally((function(){e&&window.clearTimeout(e)}))},y={init:"sjs:init"},h=function e(t){return Object.getOwnPropertyNames(t).forEach((function(a){var s=t[a];"object"===r(s)&&null!==s&&e(s)})),Object.freeze(t)},g=function(e){return"[object Object]"===Object.prototype.toString.call(e)},b=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Array.from(arguments).slice(1).filter((function(e){return!!e})).forEach((function(r){Object.keys(r).forEach((function(a){Array.isArray(r[a])?t[a]=(t[a]||[]).concat(r[a].slice(0)):g(r[a])?t[a]=e(t[a]||{},r[a]):Array.isArray(t[a])?t[a].push(r[a]):t[a]=r[a]}))})),t},j=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};a=b({},{bubbles:!0},a);var s=new Event(t,a);s.data=r,e.dispatchEvent(s)},q='[data-surveyjs-form] input:not([type="reset"]):not([type="submit"]):not([type="button"]), [data-surveyjs-form] select, [data-surveyjs-form] textarea, [data-name="bind-surveyjs-answer"]',w=function(e){return g(e)&&0===Object.getOwnPropertyNames(e).length},E=function(e){return e.matches('select, [type="radio"], [type="checkbox"], [type="file"]')},S=function(e,t){return Object.keys(e).reduce((function(t,r){var a=new RegExp("{{"+r+"}}","g");return t.replace(a,e[r])}),t)},O=function(e){return e[0].sort&&e.sort((function(e,t){return e.sort>t.sort})),e},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.trim().replace(/(([_ ])([a-z]))|(([a-z])?([A-Z]))/g,(function(e,t,r,a,s,o,n){return(a?"-"+a:(o||"")+"-"+n).toLowerCase()}));return t?r.toUpperCase():r},x=function(){var e=function(){var e="check_storage";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}();return e&&(Storage.prototype.setObject=function(e,t){this.setItem(e,JSON.stringify(t))},Storage.prototype.getObject=function(e){var t=this.getItem(e);return t&&JSON.parse(t)}),{isAvailable:e}},A={it:{loadingBox:'<div class="surveyjs-loading" data-surveyjs-loading><i class="glyphicon glyphicon-refresh icon-spin"></i> Caricamento in corso...</div>',maxChoice:"RISPOSTE MAX",fieldErrorMessage:"&Egrave; necessario rispondere.",fieldErrorMessageMultiChoice:"Devi scegliere da {{checksMin}} a {{checksMax}} risposte."},en:{loadingBox:'<div class="surveyjs-loading" data-surveyjs-loading><i class="glyphicon glyphicon-refresh icon-spin"></i> Loading...</div>',maxChoice:"ANSWERS MAX",fieldErrorMessage:"Answer is necessary.",fieldErrorMessageMultiChoice:"You must choose from {{checksMin}} to {{checksMax}} answers."}},C=function(e,t){for(var r=e.questions,a=r.length,s={},o=0;o<a;o++){var n=r[o];if(n.id==t){s=n;break}}return s},M={formOptions:{beforeSend:function(e){var t=!1,r=this,a=r.formEl.closest("[data-surveyjs-container]"),s=Array.from(a.querySelectorAll(q)),o="",n="";if(s.forEach((function(e){var a=e.type,s=e.name;if(s!==o||a!==n){e.matches("[data-required-from]")||(o=s,n=a);var i=e.closest("[data-question-id]"),c=i?i.getAttribute("data-question-id"):"",l=C(r.data,c);if(""!==c&&l&&l.required){var u=e.matches("[data-required-from]"),d=document.querySelector(e.getAttribute("data-required-from"));(!u||u&&d.checked)&&(e.required||(t=!0),e.required=!0)}}})),t){var i=b({},r.options.fieldOptions,{focusOnRelated:!1});return r.validateForm(i).then((function(t){return e.stopExecution=!0,e}))}return e},getFormData:function(){var e=this.formEl,t=e.formjs,r=Array.from(e.closest("[data-surveyjs-container]").querySelectorAll(q)),a={answers:[],id:t.data.id},s="",o="";return r.forEach((function(r){var n=r.type,i=r.name;if(i!==s||n!==o){r.matches("[data-required-from]")||(s=i,o=n);var c=r.closest("[data-question-id]"),l=c?c.getAttribute("data-question-id"):"",u={question:l,answer:{value:r.value||""}};if(!r.matches("[data-required-from]")&&""!==l&&!w(C(t.data,l))){if("radio"===n){var d=(r.closest("form")?e:r.closest(t.options.fieldOptions.questionContainer)).querySelector('[name="'+i+'"]:checked');u.answer.value=d&&d.value||"",d&&d.matches("[data-require-more]")&&(u.answer.related=e.querySelector('[data-required-from="#'+d.id+'"]').value)}"checkbox"===n&&r.matches("[data-checks]")&&(u.answer.value=[],Array.from(e.querySelectorAll('[name="'+i+'"]:checked')).forEach((function(e){u.answer.value.push(e.value)}))),a.answers.push(u)}}})),a}}},T={cssClasses:{checkbox:"form-check-input",default:"form-control",file:"form-control-file",label:"form-check-label",radio:"form-check-input",wrapper:{checkbox:"form-check",default:"",radio:"form-check"}},fieldErrorFeedback:!0,formOptions:{beforeSend:[M.formOptions.beforeSend],getFormData:M.formOptions.getFormData},initAjaxOptions:{cache:"no-store",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"},method:"GET",mode:"same-origin",redirect:"follow",timeout:0},lang:"en",templates:{fieldError:'<div class="surveyjs-field-error-message">{{fieldErrorMessage}}</div>',input:'<input {{fieldAttributes}} name="surveyjs-answer-{{questionNumber}}{{addMoreName}}" class="surveyjs-input surveyjs-{{answerType}} {{fieldClasses}}" />',label:'<label for="{{answerCode}}" class="surveyjs-label {{labelClasses}}">{{labelString}}</label>',question:'<div data-question-id="{{questionId}}" data-formjs-question class="surveyjs-question-box clearfix"><div class="surveyjs-question-header">Question {{questionNumber}}</div><div class="surveyjs-question-body"><div class="surveyjs-question-text">{{questionText}}</div><div class="surveyjs-answers-box form-group clearfix">{{answersHTML}}{{fieldErrorTemplate}}</div></div></div>',select:'<select {{fieldAttributes}} name="surveyjs-answer-{{questionNumber}}{{addMoreName}}" class="surveyjs-select {{fieldClasses}}">{{optionsHtml}}</select>',textarea:'<textarea {{fieldAttributes}} name="surveyjs-answer-{{questionNumber}}" class="surveyjs-textarea {{fieldClasses}}"></textarea>',wrapper:{default:'<div class="surveyjs-single-answer surveyjs-field-container surveyjs-answer-{{answerType}} {{wrapperClasses}}">{{fieldTemplate}}{{labelTemplate}}</div>',nested:'<div class="surveyjs-nested-parent surveyjs-single-answer surveyjs-field-container surveyjs-answer-{{answerType}}">{{labelTemplate}}<div class="surveyjs-nested-container surveyjs-field-indent">{{nestedFieldsHTML}}</div></div>',related:'<div class="surveyjs-single-answer surveyjs-field-container input-group {{wrapperClasses}}"><div class="input-group-prepend"><div class="input-group-text form-check surveyjs-answer-radio">{{fieldTemplate}}{{labelTemplate}}</div></div>{{relatedFieldHTML}}</div>'}},useWebStorage:!0},N={storageArray:[],storageName:"Survey_"+location.href+"_{{surveyFormName}}_surveyId[{{surveyId}}]"},L=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=sessionStorage.getObject(e.storageName);if(a)for(var s=a.length,o=0;o<s;o++){var n=a[o];if(n.field===t){if(r&&n.value!==r)continue;return o}}return-1},I={submit:function(e){var t=e.target.formjs;e.data.then((function(){t.options.useWebStorage&&sessionStorage.removeItem(t.internals.storageName)}))},validation:function(e){var t=e.type,r=e.target,a=r.closest("form").formjs,s=a.internals,o=r.closest(a.options.fieldOptions.questionContainer),n=r.value,i=r.matches("[data-checks]"),c=r.matches("[data-require-more]"),l=r.matches("[data-required-from]"),u=l?o.querySelector(r.getAttribute("data-required-from")):null,d=l?u:r,f=d.id?d.id.split("-")[2]:"id-not-found",p=E(r),v=C(a.data,f);if(w(v))return!0;if(p&&"change"===t||!p&&"change"!==t){if(a.options.useWebStorage&&!r.matches("[data-exclude-storage]")){var m=L(s,r.name,!!i&&n),y=L(s,r.name+"-more"),h=s.storageArray;if(c||l||-1===y||h.splice(y,1),-1!==m)i?r.checked||h[m].value!==n?h.push({field:r.name,value:n}):h.splice(m,1):""!==n?h[m].value=n:h.splice(m,1);else if(""!==n){if(l&&""!==n){var g=L(s,u.name);-1!==g&&h.splice(g,1),h.push({field:u.name,value:u.value})}if(h.push({field:r.name,value:n}),c){var b=r.closest("form").querySelector('[data-required-from="#'+r.id+'"]');h.push({field:b.name,value:b.value})}}sessionStorage.setObject(s.storageName,h)}void 0!==v.required&&(r.required=!0)}}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return O(e).reduce((function(e,t){return e+'<option value="'.concat(t.value,'">').concat(t.label,"</option>")}),"")},R=function(e,t,r){var a=["data","id","label","nested","related","sort"];/^(option|textarea)$/.test(e.type)&&a.push("type");var s="";return Object.keys(e).filter((function(e){return-1===a.indexOf(e)})).forEach((function(t){s+=" ".concat(t,'="').concat(e[t],'"')})),e.data&&Object.keys(e.data).forEach((function(t){s+=" data-".concat(k(t),'="').concat(e.data[t],'"')})),r&&(s+=" required"),e.related&&(s+=" data-require-more"),s+=' id="'.concat(t,'"'),(s+=' data-answer-id="'.concat(e.id,'"')).trim()},F=function(e,t){return{field:e[t]||e.input,label:/^(checkbox|nested|radio|related)$/.test(t)?e.label:"",wrapper:e.wrapper[t]||e.wrapper.default}},H=function e(t,r,a){var s="",o="";return O(r).forEach((function(n,i){var c,l="option"===n.type?"select":n.type;if("select"!==l||o!==l){o=l,a.question.checks&&(n=b({},n,{data:{checks:a.question.checks}}));var u="".concat(l,"-").concat(a.surveyId,"-").concat(a.question.id,"-").concat("select"===l?i+1:n.id),d={questionNumber:a.question.index+1,wrapperClasses:t.cssClasses.wrapper[l]||t.cssClasses.wrapper.default,fieldAttributes:R(n,u,a.question.isRequired),fieldClasses:t.cssClasses[l]||t.cssClasses.default,answerType:l,answerCode:u,addMoreName:"",labelString:n.label||"",labelClasses:t.cssClasses.label},f="";if(n.related){var p=n.related.type||"select",v="select"===p,m=v?b({},n):n.related;m.type=v?"option":p,m.id="".concat(n.id,"-more"),m.data=b({},m.data,{requiredFrom:"#"+u}),delete m.related;var y={fieldAttributes:R(m,"".concat(u,"-more"),!1),answerType:p,addMoreName:"-more",fieldClasses:v?t.cssClasses.select:t.cssClasses[p]||t.cssClasses.default};if(f=t.templates[p]||t.templates.input,v){var h=P(n.related);f=f.replace("{{optionsHtml}}",h)}f=S(y,f)}var g=n.related?"related":n.nested?"nested":l,j=F(t.templates,g),q="";n.nested&&(q=e(t,n.nested,a));var w="";"select"===l&&(w=P(r)),c=j.wrapper.replace("{{relatedFieldHTML}}",f).replace("{{fieldTemplate}}",j.field).replace("{{optionsHtml}}",w).replace("{{labelTemplate}}",j.label).replace("{{nestedFieldsHTML}}",q),s+=S(d,c)}})),s},_=function(e,t,r){for(var a=O(r.questions),s=a.length,o="",n=function(s){var n=a[s],i=t.templates.question,c=n.id,l=s+1,u={surveyId:r.id,question:{id:c,index:s,isRequired:!!n.required}};n.checks&&(u.question.checks=n.checks);var d=H(t,n.answers,u);if(n.external){var f=e.closest("[data-surveyjs-container]").querySelector("[data-surveyjs-external]");return f.setAttribute("data-question-id",c),n.answers.forEach((function(e,t){var r=f.querySelectorAll("[data-field]")[t],a={id:"".concat(e.type,"-").concat(u.surveyId,"-").concat(c,"-").concat(e.id),name:"".concat(r.name).concat(l),type:e.type,value:e.value,required:!!n.required};Object.keys(a).forEach((function(e){r[e]=a[e]})),r.setAttribute("data-answer-id",e.id);var s=r.closest("[data-answer]");s.querySelector("label").setAttribute("for",a.id),s.querySelector("[data-label]").innerHTML=e.label,f.querySelector("[data-question]").innerHTML=n.question})),"continue"}var p=n.checks?JSON.parse(n.checks):"",v=p[0]||"",m=p[1]||"",y=p&&t.maxChoice?" ("+m+" "+t.maxChoice+")":"",h={questionId:c,questionNumber:l,questionText:n.question+y,answersHTML:d,fieldErrorTemplate:t.fieldErrorFeedback?t.templates.fieldError:""};if(i=S(h,i),t.fieldErrorFeedback&&-1!==t.templates.fieldError.indexOf("{{fieldErrorMessage}}")){var g=""!==p?t.fieldErrorMessageMultiChoice:n.errorMessage||t.fieldErrorMessage;i=i.replace(/{{fieldErrorMessage}}/g,g)}o+=S({checksMin:v,checksMax:m},i)},i=0;i<s;i++)n(i);return o},D=function(e,t){var r=sessionStorage.getObject(t.storageName);if(r){var a=e.closest("[data-surveyjs-container]");t.storageArray=r,r.forEach((function(e){var t=a.querySelector('[name="'+e.field+'"]'),r=t.matches('[type="radio"], [type="checkbox"]'),s=r?a.querySelector('[name="'+e.field+'"][value="'+e.value+'"]'):t;r?s.checked=!0:s.value=e.value}))}},W=function(e,t,r,a){var s=e.getAttribute("name")||"";r.storageName=r.storageName.replace(/{{surveyId}}/,a.id),r.storageName=r.storageName.replace(/{{surveyFormName}}/,s);var o=_(e,t,a);e.querySelector("[data-surveyjs-body]").insertAdjacentHTML("beforeend",o),t.useWebStorage&&D(e,r)},z=function(e){e.formjs.options.fieldOptions.validateOnEvents.split(" ").forEach((function(t){var r="blur"===t;e.removeEventListener(t,I.validation,r)})),e.removeEventListener("fjs.form:submit",I.submit)},B="3.0.0",J=e("default",function(e){n(r,e);var t=f(r);function r(e){var s,o,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(this,r),!n.url||"string"!=typeof n.url)throw new Error('"options.url" is missing or not a string!');var c="string"==typeof n.lang&&n.lang.toLowerCase(),l=c&&r.prototype.messages[c]?c:r.prototype.options.lang,d=b({},r.prototype.options,r.prototype.messages[l],n);x().isAvailable||(d.useWebStorage=!1);var f=u(o=t.call(this,e,d));f.internals=N,f.options.fieldOptions.validateOnEvents.split(" ").forEach((function(e){var t="blur"===e;f.formEl.addEventListener(e,I.validation,t)})),f.formEl.addEventListener("fjs.form:submit",I.submit),f.formEl.querySelector("[data-surveyjs-body]").insertAdjacentHTML("beforebegin",f.options.loadingBox);var p=m(f.options.url,f.options.initAjaxOptions).then((function(e){return"success"!==e.status.toLowerCase()?Promise.reject(e):new Promise((function(t){e.data.questions&&e.data.questions.length>0?(W(f.formEl,f.options,f.internals,e.data),v((s=u(o),i(r.prototype)),"init",s).call(s).then((function(){f.isInitialized=!0,f.data=e.data,h(f.data),f.formEl.closest("[data-surveyjs-container]").classList.add("surveyjs-init-success"),t(e)}))):t(e)}))})).finally((function(){var e=f.formEl.querySelector("[data-surveyjs-loading]");e&&e.parentNode.removeChild(e)}));return j(f.formEl,y.init,p),o}return o(r,[{key:"destroy",value:function(){z(this.formEl),v(i(r.prototype),"destroy",this).call(this)}}],[{key:"addLanguage",value:function(e,t){var a=e.toLowerCase();r.prototype.messages[a]=b({},r.prototype.messages[a],t)}},{key:"setOptions",value:function(e){r.prototype.options=b({},r.prototype.options,e)}}]),r}(t));J.prototype.isInitialized=!1,J.prototype.messages=A,J.prototype.options=T,J.prototype.version=B}}}));
//# sourceMappingURL=surveyjs-systemjs.min.js.map
